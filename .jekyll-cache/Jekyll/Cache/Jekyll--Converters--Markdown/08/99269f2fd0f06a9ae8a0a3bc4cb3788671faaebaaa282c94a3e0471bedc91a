I"#<h2 id="beb-4th-til-58ì¼ì°¨-íšŒê³ ">[BEB 4th TIL] 58ì¼ì°¨ íšŒê³ </h2>

<p><img src="https://velog.velcdn.com/images/-__-/post/93180806-bc22-44c2-a9aa-95d3d196ee65/image.png" alt="" /></p>

<p><strong>DIDë¥¼ í™œìš©í•œ dApp ê°œë°œ</strong></p>

<h2 id="ì˜¤ëŠ˜-ë°°ìš´-ë‚´ìš©-">ì˜¤ëŠ˜ ë°°ìš´ ë‚´ìš© âœ</h2>

<ul>
  <li>DIDë¥¼ í™œìš©í•œ ì¡¸ì—…ì¦ëª…ì„œ ê°œë°œí•˜ê¸°</li>
</ul>

<hr />

<h3 id="didë¥¼-í™œìš©í•œ-ì¡¸ì—…ì¦ëª…ì„œ-ê°œë°œí•˜ê¸°-ìœ„í•œ-ì½”ë“œ">DIDë¥¼ í™œìš©í•œ ì¡¸ì—…ì¦ëª…ì„œ ê°œë°œí•˜ê¸° ìœ„í•œ ì½”ë“œ</h3>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// SPDX-License-Identifier: GPL-3.0
</span>
<span class="k">pragma</span> <span class="n">solidity</span> <span class="o">&gt;=</span><span class="mf">0.5</span><span class="p">.</span><span class="mi">0</span> <span class="o">&lt;</span><span class="mf">0.9</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>

<span class="k">contract</span> <span class="n">CredentialBox</span> <span class="p">{</span>
    <span class="kt">address</span> <span class="k">private</span> <span class="n">issuerAddress</span><span class="p">;</span>
    <span class="kt">uint256</span> <span class="k">private</span> <span class="n">idCount</span><span class="p">;</span>
    <span class="k">mapping</span><span class="p">(</span><span class="kt">uint8</span> <span class="o">=&gt;</span> <span class="kt">string</span><span class="p">)</span> <span class="k">private</span> <span class="n">alumniEnum</span><span class="p">;</span>

    <span class="k">struct</span> <span class="n">Credential</span> <span class="p">{</span>
        <span class="kt">uint256</span> <span class="n">id</span><span class="p">;</span> <span class="c1">// indexìˆœì„œë¥¼ í‘œê¸°í•˜ëŠ” idCount
</span>        <span class="kt">address</span> <span class="n">issuer</span><span class="p">;</span>
        <span class="c1">// ë°œê¸‰ì, í•˜ë‚˜ í˜¹ì€ ê·¸ ì´ìƒì˜ ì£¼ì²´ì— ëŒ€í•œ í´ë ˆì„ì„ ì£¼ì¥í•˜ê³ ,
</span>        <span class="c1">// ê·¸ í´ë ˆì„ìœ¼ë¡œë¶€í„° ê²€ì¦ê°€ëŠ¥í•œ í¬ë¦¬ë´ì…œì„ ìƒì„±í•˜ë©° ê²€ì¦ê°€ëŠ¥í•œ í¬ë¦¬ë´ì…œì„ ë³´ìœ ìì—ê²Œ ì „ë‹¬í•˜ëŠ” ì—”í„°í‹°ì˜ ì—­í• 
</span>        <span class="kt">uint8</span> <span class="n">alumniType</span><span class="p">;</span> <span class="c1">// ì¡¸ì—…ì¦ëª…ì„œ íƒ€ì…
</span>        <span class="kt">string</span> <span class="n">value</span><span class="p">;</span>
        <span class="c1">// í¬ë¦¬ë´ì…œì— í¬í•¨ë˜ì–´ì•¼í•˜ëŠ” ì•”í˜¸í™”ëœ ì •ë³´.
</span>        <span class="c1">// ì¤‘ì•™í™”ëœ ì„œë²„ì—ì„œ ì œê³µí•˜ëŠ” ì‹ ì›, ì‹ ì› ì œê³µì, ì—”í„°í‹°, ì„œëª… ë“±ì´ JSON í˜•íƒœë¡œ ì €ì¥í•œë‹¤.
</span>    <span class="p">}</span>
    <span class="c1">// ğŸ‘† ìœ„ ì½”ë“œëŠ” ê²€ì¦ê°€ëŠ¥í•œ í¬ë¦¬ë´ì…œì¸ VCë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•œ êµ¬ì¡°ì²´ì´ë‹¤
</span>
    <span class="k">mapping</span><span class="p">(</span><span class="kt">address</span> <span class="o">=&gt;</span> <span class="n">Credential</span><span class="p">)</span> <span class="k">private</span> <span class="n">credentials</span><span class="p">;</span>

    <span class="k">constructor</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">issuerAddress</span> <span class="o">=</span> <span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">;</span>
        <span class="n">idCount</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">alumniEnum</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s">"SEB"</span><span class="p">;</span>
        <span class="n">alumniEnum</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s">"BEB"</span><span class="p">;</span>
        <span class="n">alumniEnum</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s">"AIB"</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// claimCredential í•¨ìˆ˜ë¡œ Credentialì„ ë°œí–‰í•˜ê³ ,
</span>    <span class="c1">// getCredential í•¨ìˆ˜ë¥¼ í†µí•´ Credentialì„ ë°œí–‰í•œ ì£¼ì†Œì—ì„œ VCë¥¼ í™•ì¸í•˜ëŠ” ê°„ë‹¨í•œ êµ¬ì¡°ì´ë‹¤
</span>    <span class="k">function</span> <span class="n">claimCredential</span><span class="p">(</span>
        <span class="kt">address</span> <span class="n">_alumniAddress</span><span class="p">,</span>
        <span class="kt">uint8</span> <span class="n">_alumniType</span><span class="p">,</span>
        <span class="kt">string</span> <span class="k">calldata</span> <span class="n">_value</span>
    <span class="p">)</span> <span class="k">public</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">require</span><span class="p">(</span><span class="n">issuerAddress</span> <span class="o">==</span> <span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">,</span> <span class="s">"Not Issuer"</span><span class="p">);</span>
        <span class="n">Credential</span> <span class="k">storage</span> <span class="n">credential</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="n">_alumniAddress</span><span class="p">];</span>
        <span class="nb">require</span><span class="p">(</span><span class="n">credential</span><span class="p">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
        <span class="n">credential</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">idCount</span><span class="p">;</span>
        <span class="n">credential</span><span class="p">.</span><span class="n">issuer</span> <span class="o">=</span> <span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">;</span>
        <span class="n">credential</span><span class="p">.</span><span class="n">alumniType</span> <span class="o">=</span> <span class="n">_alumniType</span><span class="p">;</span>
        <span class="n">credential</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">_value</span><span class="p">;</span>

        <span class="n">idCount</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>

        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// claimCredential í•¨ìˆ˜ë¥¼ í†µí•´ ë°œê¸‰ì(issuer)ëŠ”
</span>    <span class="c1">// ì–´ë– í•œ ì£¼ì²´(_alumniAddress)ì—ê²Œ í¬ë¦¬ë´ì…œ(Credential)ì„ ë°œí–‰(claim)ì´ ê°€ëŠ¥í•˜ê²Œ ëœë‹¤
</span>
    <span class="c1">// getCredential í•¨ìˆ˜ë¥¼ í†µí•´ Credentialì„ ë°œí–‰í•œ ì£¼ì†Œì—ì„œ VCë¥¼ í™•ì¸í•˜ëŠ” ê°„ë‹¨í•œ êµ¬ì¡°ì´ë‹¤
</span>    <span class="k">function</span> <span class="n">getCredential</span><span class="p">(</span><span class="kt">address</span> <span class="n">_alumniAddress</span><span class="p">)</span>
        <span class="k">public</span>
        <span class="k">view</span>
        <span class="k">returns</span> <span class="p">(</span><span class="n">Credential</span> <span class="k">memory</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">credentials</span><span class="p">[</span><span class="n">_alumniAddress</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="c1">// getCredential í•¨ìˆ˜ë¥¼ í†µí•´ ì–´ë– í•œ ì£¼ì²´(_alumniAddress)ë¥¼ í†µí•˜ì—¬
</span>    <span class="c1">// ë°œí–‰(claim)í•œ í¬ë¦¬ë´ì…œ(Credential)ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤
</span><span class="p">}</span>

<span class="c1">// JWT ë¡œ ì•”í˜¸í™”ëœ í† í°
// eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiaWRwIjoiY29kZSBzdGF0ZXMiLCJ0eXBlIjoiYmViIiwidG9rZW4iOiJ0ZXN0IiwidmFsdWUiOiLsvZTrk5zsiqTthYzsnbTsuKAgRElEIOyImOujjOymnSDrsJzquInsnYQg7JyE7ZWcIO2BrOumrOuNtOyFnCDthYzsiqTtirgifQ.qXTgkPcK43uZ4_FBLBTFjaTsnmV9sAAekgK8BUZBt1g
</span></code></pre></div></div>

<p><img src="https://velog.velcdn.com/images/-__-/post/daddd906-c06c-4b77-8447-8797a041d844/image.png" alt="" /></p>

<blockquote>
  <ul>
    <li>alumniAddress ğŸ‘‰ Credentialì„ ë°œí–‰ë°›ì„ í…ŒìŠ¤íŠ¸ë„· ì£¼ì†Œ</li>
    <li>alumniType ğŸ‘‰ ì¡¸ì—…ì¦ëª…ì„œ íƒ€ì…. BEBì´ë¼ë©´ 1 ì…ë ¥</li>
    <li>value ğŸ‘‰ JWTë¡œ ì•”í˜¸í™”ëœ í† í°</li>
  </ul>
</blockquote>

<hr />

<p><img src="https://velog.velcdn.com/images/-__-/post/035d2af7-ad3d-412b-88c2-7dcbc0d95261/image.png" alt="" /></p>

<blockquote>
  <p>Credential ì»¨íŒì´ ì™„ë£Œë˜ì—ˆë‹¤ë©´, getCredentialí•¨ìˆ˜ ì‹¤í–‰<br /></p>

  <ul>
    <li>alumniAddress : Credentialì„ ë°œí–‰ë°›ì€ ì£¼ì†Œ</li>
  </ul>
</blockquote>

<hr />
:ET